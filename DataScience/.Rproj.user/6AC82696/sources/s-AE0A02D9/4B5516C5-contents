#1
data = read.table('https://imag.umontpellier.fr/~toulemonde/filesIG4/CoursAD/Donnees/vacances.txt')
library('FactoMineR')

#2
proba <- c(0.25,0.75)
khi_test = chisq.test(data,p=proba)
#khi2 = 2292
#pvalue = 0 
#On rejette donc l'independance

#3
afc_data = CA(data)
str(afc_data)
#4
eigenvalues <- afc_data$eig
barplot(eigenvalues[,1],names.arg =1:nrow(eigenvalues),main="Valeurs propres", xlab ="Principal Components", ylab="eigenvalue", col="steelblue")
lines(x = 1:nrow(eigenvalues), eigenvalues[, 1], type="b", pch=19, col = "red")

#5
afc_data$row$coord

#6

#7
fiplus <- margin.table(vacances,1)/margin.table(vacances)
fplusj <- margin.table(vacances,2)/margin.table(vacances)
(fiplus[1]*(afc_data$row$coord[1,1]^2)/afc_data$eig[1,1])
afc_data$row$contrib


#8 Transformer le tableau d'origine en objet table

margin.table(vacances,1)
# pour avoir les marges du tableau par rapport aux lignes

margin.table(vacances,2)
# pour avoir les marges du tableau par rapport aux colonnes

prop.table(vacances,1)
# matrice de profils lignes

prop.table(vacances,2)
# matrice de profils colonnes


