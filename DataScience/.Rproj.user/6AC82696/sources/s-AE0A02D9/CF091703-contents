#load data
mails_acp <- read.csv("/Users/pierreperrin/Desktop/IG4/semestre7/Projet_DataScience/dataset_first_acp_test.csv")
mails_acm <- read.csv("/Users/pierreperrin/Desktop/IG4/semestre7/Projet_DataScience/dataset_first_acp_test.csv")

mails_anova1 <- read.csv("/Users/pierreperrin/Desktop/IG4/semestre7/Projet_DataScience/anova1.csv")
mails_anova1_1 <- read.csv("/Users/pierreperrin/Desktop/IG4/semestre7/Projet_DataScience/anova1_1.csv")
mails_anova1_2 <- read.csv("/Users/pierreperrin/Desktop/IG4/semestre7/Projet_DataScience/anova1_2.csv")


mails_afc1_1_non_transmit <- read.csv("/Users/pierreperrin/Desktop/IG4/semestre7/Projet_DataScience/dataset_afc1_non_transmit.csv")
mails_afc1_2 <- read.csv("/Users/pierreperrin/Desktop/IG4/semestre7/Projet_DataScience/dataset_afc1_2.csv")

#load library 
library(FactoMineR)

#pas de lien entre la la taille du contenu la taille du sujet le nombre de cc
resPCA <- PCA(mails)
resPCA$ind

#tester l'hypthe d'homoscédasticité
barlett.test(mails_anova1_1)

#anova1_1 facteur content_size et moment
summary(aov(mails_anova1_1$content_size~mails_anova1_1$Moment))
# le moment de la journée suivant lequel on envoit le mail influe sur la taille du mail -> afc pour voir le lien entre le moment de la journée et la taille (gros, petit, moyen)

#anova1_2 facteur subject_size et moment
summary(aov(mails_anova1_2$subject_size~mails_anova1_2$Moment))


#afc sur le moment de la journée ou le mail a était envoyé et la taille qualitative de celui ci
table(mails_afc1_1[,1], mails_afc1_1[,2]) -> afc_1
afc_moment_content_size <- CA(afc_1)
table(mails_afc1_1_non_transmit[,1], mails_afc1_1_non_transmit[,2]) -> afc_1_non_transmit
afc_moment_content_size_non_transmit <- CA(afc_1_non_transmit)

proba <- c(0.25,0.75)
khi_test = chisq.test(afc_1_non_transmit,p=proba)
khi_test$statistic
#khi2 = 666,47
#On rejette donc l'independance
str(afc_moment_content_size_non_transmit)


#afc sur le moment de la journée ou le mail a était envoyé et la taille qualitative du sujet de celui ci
table(mails_afc1_2[,1], mails_afc1_2[,2]) -> afc_2
afc_moment_subject_size <- CA(afc_2)
khi_test2 = chisq.test(afc_2,p=proba)
#khi2 = 849,98


